#!/usr/bin/env ruby

require 'dotenv/load'
require_relative '../lib/data_retriever'
require_relative '../lib/new_entries'

# Data Retriever
include DataRetriever
include NewEntries
puts "\nStarting...\n"


# Selecting Workspace
workspaces = DataRetriever.workspaces reload: true
puts "Option\tWorkspace"
i = 1
workspaces.each do |w|
  puts "#{i}\t#{w['name']}"
  i += 1
end
print "Select a Workspace: "
option = gets.chomp.to_i
selected_workspace = workspaces[option - 1]
puts "\nSelected #{selected_workspace["name"]}"


workspace_projects = DataRetriever.projects workspace_id: selected_workspace["id"], reload: true
puts "Option\tProject"
i = 1
workspace_projects.each do |p|
  puts "#{i}\t#{p['name']}"
  i += 1
end
print "Select a Project: "
option = gets.chomp.to_i
selected_project = workspace_projects[option - 1]
puts "\nSelected #{selected_project["name"]}"

puts "\nCreating new repeated Tasks Group"
print "Task Description: "
description = gets.chomp
print "Start Date (YYYY-MM-DD): "
start_date = gets.chomp
print "End Date (YYYY-MM-DD): "
end_date = gets.chomp
print "Start Time (HH:MM): "
start_time = gets.chomp
print "End Time (HH:MM): "
end_time = gets.chomp

NewEntries.time_entry(start_date, end_date, start_time, end_time, description, selected_project['id'], selected_workspace['id'])